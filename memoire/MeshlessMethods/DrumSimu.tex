% !TEX root = ./memoire/main.tex

\section{Méthodes particulaires pour la simulation}~\label{sec:simu_part}

% \section{Introduction}
% Nous avons vu dans le chapitre précédent que l'assimilation dépendait en particulier de la définition d'un modèle et de son état. 
% Or, si les méthodes d'assimilation peuvent facilement s'exprimer pour des méthodes eulériennes sur grille ou maillage fixe, elles soulèvent des questionnements lorsque les méthodes reposent sur des discrétisations lagrangiennes. De plus, il faut aussi différentier la nature de la représentation. Le fait que l'espace soit continu ou discret va également modifier la signification de l'état et sa capacité à être mis à jour.
Les méthodes de simulation de l'écoulement au sein du broyeur à boulets reposent principalement sur des discrétisations particulaires comme évoqué en Section~\ref{sec:methode_resolution}. C'est ce type de modélisation qu'il faut prendre en compte dans nos algorithmes d'assimilation de données. Dans cette section, nous reprendrons les principales familles de formulation particulaire en considérant les méthodes discrètes et celles discrétisant un milieu continu. En plus des méthodes particulaires pour la modélisation de l'écoulement granulaire, nous présenterons la méthode vortex en Section~\ref{sec:vortex} comme une méthode modèle pour la suite du manuscrit.

\subsection{Méthodes des éléments discrets, \textit{Discrete element method} (DEM)}~\label{sec:part_discret}

Les méthodes particulaires discrètes considèrent les particules comme des objets solides indépendants. Ces entités physiques sont caractérisées par leur géométrie, des propriétés intrinsèques conservées comme la masse ou l'inertie, et des variables cinématiques comme la vitesse ou l'accélération. Les particules interagissent entre elles au travers de lois de contact, de frottement et de cohésion. L'objectif est de déterminer la trajectoire des particules. Parmi ces méthodes, on peut mentionner la méthode des éléments discrets (DEM)~\cite{radjai:hal-00691805} et la méthode de dynamique des contacts (CD)~\cite{moreau:hal-01824750}. La principale différence entre ces deux méthodes est de considérer respectivement des particules déformables ou non. Sans perte de généralité pour l'applicabilité au problème d'assimilation, nous présenterons la méthode classique DEM.

% \subsubsection{Méthodes des éléments discrets, \textit{Discrete element method} (DEM)}
La DEM~\cite{cundall_discrete_1979} est une extension du problème à $N$-corps introduit dans les années 60 aussi bien pour la dynamique moléculaire~\cite{Alder1959}, la dynamique des fluides~\cite{Allen1987}, ou encore l'astrophysique~\cite{vonHoerner1960}.
La méthode consiste à considérer le mouvement d'un ensemble de $N$ grains composant le milieu.

Le principe fondamental de la dynamique s'applique sur cet ensemble, et s'exprime pour chaque particule sous la forme

\begin{equation*}
    \left\{
    \begin{aligned}
         & m_{i} \frac{ d^{2}\bm{x}_i }{dt^2}=\bm{f}_{i},\; i=1\ldots N \\
         & I_{i} \frac{d \bm{\omega}_{i}}{dt}=\bm{M}_{i},\; i=1\ldots N
    \end{aligned}
    \right.
\end{equation*}où $N$ est le nombre de grains, $m_{i}$ est la masse, $I_i$ est le moment d'inertie, $\bm{x}_{i}$ est la position, $\bm{\omega_{i}}$ est la rotation, $\bm{f}_{i}$ est la force exercée sur le grain considéré et $\bm{M_{i}}$ le moment associé à la force $\bm{f}_{i}$.

Le couplage entre particules s'exprime au travers de la force $\bm{f}_{i}$ qui se décompose comme
\begin{equation*}
    \bm{f}_{i}=\underset{{\scriptstyle j\neq i}}{\sum}\bm{f}^{c}_{ij}+\bm{f}_i^{\text{ext}}
\end{equation*}

où $\bm{f}^{c}_{ij}$ est la force induite par le contact de la particule $i$ avec la particule $j$, et $\bm{f}_ i^{\text{ext}}$ la force au centre de la particule $i$ (par exemple la force de gravité).

Les forces de contact sont décrites par des lois de contact entre grains, et entre grains et la paroi à la frontière du domaine. Dans le cas élastique, la modèle de Hertz est adapté pour décrire l’interaction normale. Le modèle Hertz-Mindlin permet de déterminer les interactions tangentielles élastiques. Ces loi sont fonctions de l'interpénétration et de la vitesse relative interparticulaire. Par exemple, dans le cas de particules sphériques, l'interpénétration est définie comme $\delta_{ij} = \norm{\bm x_i - \bm x_j} - (R_i - R_j)$ où $\bm x$  est la position du centre du grain et $R$ son rayon. De même, on défini des loi de contact pour décrire la composante tangentielle.

La force de contact tend ainsi à pénaliser l'interpénétration via des coefficients de raideur $k$ et d'amortissement $\gamma$ qui dépendent des propriétés mécaniques des grains de la paroi. Il existe plusieurs algorithmes pour résoudre numériquement les équations de la dynamique. Le plus utilisé est l'algorithme de Verlet en vitesse~\cite{verlet_1982}.

% Le processus de simulation DEM dans un mélangeur-broyeur commence par la définition des propriétés des particules et des conditions initiales du système. Le mouvement de chaque particule est ensuite calculé en résolvant les équations de Newton pour le mouvement et la rotation. Ces calculs tiennent compte des forces et des moments résultant des collisions et des interactions entre particules, ainsi que de l'interaction des particules avec les parois du broyeur.

\subsection{Méthodes particulaires discrétisant un milieu continu}\label{sec:part_cont}

Des méthodes particulaires sont également envisagées pour résoudre des problèmes en milieu continu en mécanique des fluides ou des solides. Cela inclut des méthodes telles que l'hydrodynamique par particules lissées (SPH) \cite{lucy_1977,gingold_monaghan_sph_1977} et la méthode des vortex (VM) \cite{cottet_vortex_2000}, et s'étend à d'autres méthodes comme la méthode des points de matériau (MPM) \cite{sulsky_particle_1994}. Cette fois, elles partagent toutes de décomposer le domaine en un ensemble $\mathcal{P}$ de particules qui suivent la dynamique du problème. Les particules ne sont donc pas ici des entités physiques distincts. Nous parlerons de grain pour les méthodes discrètes et de particule pour les méthodes continues. Ainsi, la discrétisation suit la transformation appliquée au milieu en transportant des quantités attachées à chaque particule. Elles sont en cela des méthodes lagrangiennes.

\subsubsection{Formulation particulaire}

\subsubsection{Discrétisation à l'aide de particules}

La solution représentée par un jeu de «particules» est obtenue grâce à deux éléments: une approximation grâce à un noyau de lissage et l'approximation particulaire d'un opérateur intégral. Si la représentation de la solution peut évoluer suivant la méthode (en particulier avec la méthode MPM), la solution peut toujours être exprimée de cette manière suivant le choix du noyau.

Tout champ régulier $\bm{u}$ sur $\Omega \times \mathbb R^+$ peut être écrit grâce à la propriété de criblage du Dirac

\begin{equation*}
    \bm{u}(\bm{x}, t) = \int_{\Omega} \bm{u}(\bm{x}', t) \delta(\bm{x}' - \bm{x})  d\bm{x}',
\end{equation*}avec $\delta$ la distribution de Dirac.

Une fonction de noyau $\phi_\varepsilon$ est introduite pour obtenir une estimation moyenne $\langle \bm{u} \rangle$ de $\bm{u}$ telle que

\begin{equation*}
    \langle \bm{u}(\bm{x}, t) \rangle = \int_{\Omega} \bm{u}(\bm{x}', t) \phi_\varepsilon(\bm{x}-\bm{x}') d\bm{x},
\end{equation*}où $\varepsilon$ est la longueur de lissage. Le noyau lisse doit au moins respecter les propriétés suivantes

\begin{gather*}
    \left\{\begin{aligned}
         & \int_{\Omega} \phi_\varepsilon(\bm{x}) d\bm{x} = 1,                  \\
         & \phi_\varepsilon(\bm{x}) \to \delta(\bm x), \quad \varepsilon \to 0, \\
         & \phi_\varepsilon(\bm{x}) \in C^k,  \quad k \geq 1,
    \end{aligned} \right.
\end{gather*}où les deux premières propriétés sont des propriétés résiduelles de la distribution de Dirac et la dernière est une exigence de différentiabilité nécessaire pour approcher les opérateurs différentielles. La fonction moyenne $\langle \bm{u} \rangle$ est ensuite utilisée pour approximer la fonction d'origine. Dans un second temps, le domaine d'origine $\Omega$ est subdivisé avec $N_p$ sous-domaines $\Omega_p$ associés à une particule lagrangienne à l'emplacement $\bx_p(t) \in \Omega_p$. Nous notons $V_p$ le volume de $\Omega_p$. Par la suite, nous noterons $\mathcal P = $ l'ensemble des particules de cette partition spatiale. Cette discrétisation est ensuite utilisée pour approximer la fonction moyenne par une méthode de quadrature sur les particules telles que

\begin{eqnarray*}~\label{eq:part_approx}
    \langle \bm{u}(\bm{x}, t) \rangle &=& \sum_{p \in \mathcal P} \int_{\Omega_p} \bm{u}(\bm{x}', t) \phi_\varepsilon(\bm{x}-\bm{x}') d\bm{x}' \\
    &\simeq& \sum_{p \in \mathcal P} \bm{u}(\bm{x}_p(t), t) V_p \phi_\varepsilon (\bm{x}-\bm{x}_p(t)) \\
    &\simeq& \sum_{p \in \mathcal P} \bm{\Gamma}_p(t) \phi_\varepsilon (\bm{x}-\bm{x}_p(t)).
\end{eqnarray*}

Ainsi, toute fonction définie sur une discrétisation par particule est définie par un ensemble de positions de particules $\bm{x}_p$ associées à une valeur de particule $\bm{\Gamma}_p(t) = \bm{u}(\bx_p, t) V_p$ et un noyau lisse $\phi_\varepsilon$. Sur la base de cette discrétisation, l'opérateur différentiel peut être dérivé à travers cette formulation. Tout comme le champ $\bm u$, la même interpolation peut être appliquée pour obtenir

\begin{equation*}
    \nabla \bm{u}(\bm{x}, t) = \sum_{p \in \mathcal P} \bm{U}_p(t) \nabla \phi_\varepsilon (\bm{x}-\bm{x}_p(t)).
\end{equation*}

Il existe toutefois une grande variété de formule pour approximer l'opérateur gradient. Dans ce cas, ce sont les propriétés de conservation associées au champ qui sont privilégiées.
Généralement, un terme additionnel est introduit lorsque le champ est évalué à la position d'une particule $p \in \mathcal P$ tel que

\begin{equation*}
    \nabla \bm{u}(\bm{x}_p(t), t) = \sum_{q \in \mathcal P} (\bm{U}_q(t) - \bm{U}_p(t)) \nabla \phi_\varepsilon (\bm{x}_q(t)-\bm{x}_p(t)),
\end{equation*}où $\sum_q \bm{U}_p(t) \nabla \phi_\varepsilon (\bm{x}_q(t)-\bm{x}_p(t))$ est nul par propriété de localisation du noyau $\phi_\varepsilon$.

Finalement, l'ensemble de particules $\mathcal P$ va permettre de résoudre les équations de la dynamique, et ce, soit par discrétisation des opérateur de la formulation forte comme avec la méthode SPH, soit par discrétisation de la formulation faible comme avec la méthode MPM. Ainsi, un modèle d'évolution est associé aux positions $\bx_p(t)$ et intensités $\bm \Gamma_p(t)$ tel que

\begin{gather}~\label{eq:model_evol}
    \left\{\begin{aligned}
         & \frac{d\bm \Gamma_p(t)}{dt} = M_\Gamma(\bm \Gamma_p(t); \mathcal P), \\
         & \frac{d \bx_p(t)}{d t} = M_x(\bx_p(t); \mathcal P).
    \end{aligned} \right.
\end{gather}C'est en particulier grâce à la mise à jour de la position $\bx_p$ qui le terme d'advection est pris en compte dans la résolution du problème dynamique.

\subsubsection{Exemples de fonction de noyau}

Plusieurs noyaux ont été utilisés en fonction de la méthode. La formulation originale de la MPM n'utilise pas de noyau de substitution et écrit la densité comme suit

\begin{equation*}
    \bm{u}(\bm{z}, t) = \sum_{p \in \mathcal P} \bm{U}_p(t) \delta (\bm{z}-\bm{z}(t)_p).
\end{equation*}Finalement, ce n'est pas tant cette fonction que la projection sur une grille de fond associée à certaines fonctions de forme qui est utilisé pour discrétiser le problème~\cite{sulsky_particle_1994}. La méthode GIMP~\cite{bardenhagen_generalized_2004} est une formulation différente qui utilise la fonction de Heaviside et associe donc bien volume autour de chaque particule

\begin{equation*}
    M_1(r) = \frac{\alpha}{\varepsilon}\left\{\begin{aligned}
         & 1; & r \leq \varepsilon, \\
         & 0; & \text{sinon},
    \end{aligned}
    \right.
\end{equation*}où $r = \norm{\bm{z}}_2$ et $\alpha$ un facteur de normalisation. Cette méthode a été introduite pour éviter le problème de \textit{cell crossing} lorsque une particule se déplace d'une cellule à une autre à travers la grille de fond. Dans la méthode SPH, comme son nom l'indique, un noyau lisse est associé pour approximer la solution. Théoriquement, il pourrait s'agir de la fonction de noyau gaussien

\begin{equation*}
    \phi_g(r) = \frac{1}{{(\pi \varepsilon^2)}^{d/2}} \exp(-r^2/\varepsilon^2).
\end{equation*}

Ce noyau est infiniment différentiable mais défini sur un support non-compact. En pratique, nous utilisons un seuillage pour supprimer les valeurs négligeables pour une grande distance par rapport à une particule. D'autres noyaux, basés sur des fonctions B-Spline, permettent de travailler sur un support compact. Ces fonctions sont également positives, ce qui est une exigence pour certains champs comme la densité. Par exemple, le B-spline quadratique $M_3$  est défini par
\begin{equation*}~\label{quadratic_kernel}
    M_3(r) = \frac{\alpha}{\varepsilon^d}\left\{ \begin{aligned}
         & \frac{3}{4} - |q|^2                            & 0 \leq           & |q| < \frac{1}{2} \\
         & \frac{1}{2} {\left(\frac{3}{2} - |q|\right)}^2 & \frac{1}{2} \leq & |q| < \frac{3}{2} \\
         & 0                                              & \frac{3}{2} \leq & |q|
    \end{aligned}
    \right.
\end{equation*}avec $r = \norm{z}_2 $, $q = r / \varepsilon$ et $\alpha$ la condition de normalisation et $d$ la dimension spatiale. Ce noyau garantit la continuité $C^1$. Le noyau cubique est un autre noyau B-Spline qui est
\begin{eqnarray*}~\label{cubic_kernel}
    M_4(r) &=&  \frac{\alpha}{\varepsilon^d} \left\{ \begin{aligned}
         & \frac{1}{6}{(-|q|+2)}^3 - \frac{4}{6}{(-|q|+1)}^3 & 0 \leq      & |q| \leq  1 & \\
         & \frac{1}{6}{(- |q|+2)}^3                          & 1      \leq & |q| \leq 2  & \\
         & 0                                                 & 2 \leq      & |q|
    \end{aligned}
    \right.
\end{eqnarray*}Dans ce dernier cas, le facteur de normalisation $\alpha$ est

\begin{equation*}
    \alpha = \left\{ \begin{aligned}
         & 1;    \quad      & 1\text{ d} \\
         & 30/14 \pi; \quad & 2\text{ d} \\
         & 3/ 2\pi; \quad   & 3\text{ d}
    \end{aligned}
    \right.
\end{equation*}Notons que ces noyaux ont été définis avec la coordonnée radiale $r$. Une autre possibilité serait de définir le noyau multidimensionnel comme le produit tensoriel du noyau 1d. C'est ce qui est généralement fait pour définir les fonctions de forme associées à la grille de la méthode MPM ou bien les noyaux de redistribution utilisés pour remailler une discrétisation particulaire comme en Section~\ref{remesh_part}.

\subsubsection{Distribution particulaire admissible}~\label{sec:part_admissible}

Les méthodes particulaires sont ici des méthodes d'approximation de champs continus. Ces discrétisations doivent ainsi vérifier un certain nombre de critères pour être conforme à la solution. Il s'agit en particulier de donner ici des critères de régularité pour définir si une méthode d'interpolation particulaire est valide. On trouvera des détails supplémentaires dans le livre~\cite{s_li_meshfree_2004} Chapitre 4. On rappelle tout d'abord ce qu'est le support d'une particule $p$. Chaque particule est associée à une fonction d'interpolation $\phi_\varepsilon(\bm{z})$. Le support compact est donc

\begin{equation*}
    S_p = \{\bx \mid \| \phi_\varepsilon (\bx - \bx_p) \| > 0\} \cap \Omega,
\end{equation*}On définit également $\rho_p$ le rayon du support compact comme
\begin{equation*}
    \rho_p =  \max \{\| \bx - \bx_p \| > 0 \mid \bx \in S_p\}.
\end{equation*}C'est l'ensemble de ces sous-domaines qui forment la distribution particulaire. Nous supposons un nombre fini de particules comme décrit précédemment.% et un rayon de support homogène $\rho = \rho_I$.

\begin{definition}[distribution particulaire admissible]
    On définit une distribution admissible selon plusieurs conditions
    \begin{enumerate}
        \item L'union des supports de particules~\label{it:cond1}
              \begin{equation*}
                  S:= \bigcup_{p \in \mathcal P} S_p
              \end{equation*}
              est inclus dans le domaine $\bar \Omega$ dans lequel réside de tel sorte que $\bar \Omega	\subseteq S$.
        \item $\forall \bx \in \Omega$, il existe une boule~\label{it:cond2}
              \begin{equation*}
                  \mathcal B(x) = \{x \mid \|\bx - \bar \bx\| < \rho\}
              \end{equation*}tel que le nombre de particule dans $\mathcal B$ satisfait deux bornes $0 < N_{min} < N_{max} < \inf$
              \begin{equation*}
                  N_{min} \leq N \leq N_{max}
              \end{equation*}% de telle sorte que la matrice des moments vérifie les conditions suivante
              %   \begin{itemize}
              %       \item la matrice de moment est de dimension finie ;
              %       \item la matrice de moment est inversible ;
              %       \item la matrice de moment est bien conditionnée.
              %   \end{itemize}
              \item~\label{it:cond3} Pour $\Omega \in \mathbb R^d$, il est nécessaire que $B(x)$ admette au moins $d+1$ particules dont les vecteurs positions sont distincts.%, de cette manière la matrice de moment est nécessairement inversible.
    \end{enumerate}
\end{definition}

La condition~\ref{it:cond1} est une condition de recouvrement. Cette dernière est une condition nécessaire de la condition~\ref{it:cond2}. Elle peut être vue comme une condition de chevauchement, nécessaire afin de «lier» les particules entre elles. Finalement, la condition~\ref{it:cond3}
La définition d'admissibilité a été développée en termes de ($\rho, p$)-régularité par Han et Meng~\cite{HAN20016157} et par Duarte et Oden~\cite{duarte1996hp}.

Cette définition est en particulier déterminante pour pouvoir appliquer les schémas d'interpolation définis dans la Section~\ref{interpOp}.

\subsection{Hydrodynamique des particules lissées, \textit{Smoothed particle hydrodynamics} (SPH)}

La méthode SPH a été développée indépendamment par Lucy~\cite{lucy_1977}, et Gingold et Monaghan~\cite{gingold_monaghan_sph_1977}. Elle a été formulée initialement pour des problème de formation et d'évolution des systèmes stellaires~\cite{hultman1999hierarchical} mais elle trouve un gain d'intérêt considérable en mécanique des fluides~\cite{PhysRevE.52.4899, SHADLOO201611}. Toutefois, la méthode n'est pas interprétée de la même manière. D'une part, comme en mécanique quantique elle est utilisée pour lisser un système discret afin d'obtenir un milieu continu discrétisé par un ensemble de particules. En mécanique, cette méthode est vu comme une méthode de discrétisation particulaire d'un milieu continu. C'est cette représentation que nous utilisons ici.

Les particules sont des interpolants qui transportent toutes les quantités nécessaires comme la densité, la vitesse, le tenseur de contrainte ou l'énergie. Elle consiste à résoudre la forme forte des équations de la dynamique. Les équations résolues sont l'équation de continuité et l'équation de conservation de la quantité de mouvement à travers l'équation d'Euler

\begin{gather*}
    \left\{\begin{aligned}
        \frac{d\rho}{dt} + \rho \nabla \cdot \bm{v} = 0, \\
        \frac{d\bm v}{dt} = \frac1\rho \nabla \cdot \bm \sigma,
    \end{aligned} \right.
\end{gather*}où $\rho$ est la densité, $\bm v$ la vitesse, $\bm \sigma$ la contrainte de Cauchy.

En utilisant la règle d'approximation du gradient le terme $\rho \nabla \cdot \bm{v}$ peut être approximé pour chaque particule $p \in \mathcal P$, ce qui donne pour l'équation de continuité

\begin{equation*}
    \frac{d\rho_p}{dt} = \sum_{q \in \mathcal P} m_j (\bm v_q - \bm v_p) \cdot \nabla \phi_\varepsilon(\bm x_p - \bm x_q),
\end{equation*}où $m_p$ est la masse de la particule assignée initialement comme $m_p = \rho_p V_p$, et $\bm v_p$ sa vitesse. L'équation d'équilibre des quantités de mouvement est discrétisée de la même manière. La forme suivante est généralement utilisée

\begin{equation*}
    m_p \frac{d \bm v_p}{dt} = \sum_{q} m_p m_q \left(\frac{\bm \sigma_p}{\rho_p^2} + \frac{\bm \sigma_q}{\rho_q^2} \right) \cdot \nabla \phi_\varepsilon(\bm x_p - \bm x_q).
\end{equation*}Cette version est symétrique par rapport aux indices $p$ et $q$ ce qui favorise les propriétés de conservation. Comme défini en~\eqref{eq:model_evol}, on obtient alors des équations d'évolution des quantités particulaires pour la densité $\rho_p$ et la vitesse $\bm v_p$ qui sera utilisé pour mettre à jour la position des particules $\bx_p$ au travers d'un schéma d'intégration temporel comme un algorithme \textit{leap-frog}. La variable de contrainte $\bm \sigma_p$ est mise à jour au travers d'une loi de comportement. En pratique, pour des problèmes de choc ou dominé par la convection, un terme de viscosité artificiel est ajouté dans l'équation d'évolution de la vitesse~\cite{MONAGHAN1983374}.

\subsection{Méthode des points matériels, \textit{Material Point Method} (MPM)}~\label{sec:mpm}

La méthode des points matériels (MPM) est une autre méthode particulaire qui utilise une double description: lagrangienne au travers de particules et eulérienne à l'aide d'une grille fixe. Tout comme la méthode SPH, elle utilise une discrétisation particulaire, les points matériels, qui en se déplaçant transportent toutes les quantités nécessaires pour le problème : masse, vitesse, tenseur de déformation, ou variables internes. D'autre part, l'interpolation du champ de déplacement est réalisé à l'aide de coordonnées spatiales de la grille fixe et souvent régulière. Les deux discrétisations interagissent au travers d'opérateurs de projection et interpolation entre particules et les nœuds et de la grille qui les entourent. Cette méthode fait parti de la famille \textit{particle-in-cell} (PIC). La méthode MPM est un adaptation en mécanique des solides développé par Sulsky et al.~\cite{sulsky_particle_1994} de la méthode FLIP de Brackbill~\cite{brackbill_flip_1988} en mécanique des fluides.

Comme en éléments finis, la méthode MPM consiste à résoudre le problème aux valeurs sous sa forme faible

\begin{equation*}~\label{eq:form_faible}
    \int_\Omega \rho \bm a \cdot \bm q d\Omega = - \int_\Omega \rho \bm \sigma : \nabla \cdot \bm q d\Omega + \int_\Omega \rho \bm b\cdot \bm q d\Omega + \int_{\partial \Omega_t}  \bm t \cdot \bm q dS.
\end{equation*}où $\bm a$ est l'accélération, $\bm v$ la vitesse, $\bm \sigma$ le tenseur de contrainte$, \bm q$ une fonction test, $\bm t$ le vecteur de traction et $\bm b$ la force volumique.
% Le problème aux conditions limites, sous sa forme forte, se composent des équations d'équilibre, des lois matériels, de l'équation cinématique et des conditions limites et initiales donnant

% \begin{equation*}
%     \begin{cases}
%         \begin{aligned}
%              & \frac{D \rho}{Dt} + \rho \nabla \cdot \bm v  =  0                          ,                                                                         & \quad \text{(conservation de la masse)}                  \\
%              & \rho \frac{D \bm v}{Dt}                      =  \nabla \cdot \bm \sigma + \rho \bm b,                                                                & \quad  \text{(conservation de la quantité de mouvement)} \\
%              & \bm \sigma = LdC(\bm F),                                                                                                                             & \quad  \text{(loi de comportement)}                      \\
%              & \bm u(\bm z, t) = \bar{\bm u}, \quad \forall \bm z \in \Gamma_u,    \quad  \bm \sigma (\bm z) \cdot \bm n = \bm t, \quad \forall \bm z \in \Gamma_t, & \quad  \text{(conditions limites)}                       \\&\bm v(\bm z, t = 0), \quad \bm \sigma(\bm z, t= 0) = \bm \sigma_0. & \quad  \text{(conditions initiales)} \\
%         \end{aligned}
%     \end{cases}
% \end{equation*}

Le schéma MPM peut être obtenu en concentrant la masse sur $N_p$ particules. La densité est alors représentée comme un somme de Dirac

\begin{equation*}
    \rho(\bm x) = \sum_{p \in \mathcal P} V_p~\rho_p \delta(\bm x - \bm x_p) = \sum_{p \in \mathcal P} m_p \delta(\bm x - \bm x_p)
\end{equation*}

De même, on discrétise la contrainte $\bm \sigma$

\begin{equation*}
    \bm \sigma(\bm x) = \sum_{p \in \mathcal P} \bm \sigma_p \delta(\bm x - \bm x_p).
\end{equation*}
On trouve un certain nombre de généralisation dans la littérature comme la méthode GIMP~\cite{bardenhagen_generalized_2004} en définissant une représentation particulaire de la densité où les Dirac sont remplacés par des fonction caractéristique $\chi_p$ tel que

\begin{equation*}
    \rho(\bm z) = \sum_{p \in \mathcal P} m_p \chi(\bm z - \bm z_p)
\end{equation*}.

Finalement, en injectant cette discrétisation de la densité dans l'équation~\eqref{eq:form_faible}

\begin{multline*}
    \sum_{p \in \mathcal P} m_p \bm q(\bm z_p(t), t)\cdot \bm a(\bm z_p(t), t) = - \sum_{p \in \mathcal P} m_p \bm \sigma(\bm z(t), t) : \nabla \bm u(\bm z(t), t) \\
    + \int_{\partial \Omega_t} \bm t \bm q dS + \sum_{p} m_p \bm q(X(t), t) \cdot \bm b(X(t), t).
\end{multline*}

Les variables cinématiques sont ensuite discrétisées sur la grille eulérienne. La précédente équation est résolue sur la grille et l'accélération est déterminée sur chaque nœud $I \in \Lambda$ de la grille comme

\begin{equation*}\label{eq:mpm_pfd}
    \sum_{J \in \Lambda} m_{IJ} \bm a_J = \bm f_I^{\text{int}} + \bm f_I^{\text{ext}},
\end{equation*}ou $m_{IJ}$ la matrice de masse, $\bm f_I^{\text{int}}$ sont les forces internes, et $\bm f_I^{\text{ext}}$ les forces externes.

En pratique, afin d'obtenir $m_{IJ},\bm a_J,\bm f_I^{\text{int}}$ à partir des quantités particulaires, les deux niveaux de discrétisation communique selon des étapes de projection (\textit{particles to grid}) puis d'interpolation (\textit{grid to particles}).

\paragraph*{projection}

Les valeurs de la grille sont initialisées à 0. La masse $m_p$,la quantité de mouvement $m_p \bm v_p$ et les forces $\bm f_p$ sont transférées à la grille à l'aide des fonctions de forme $\phi_I$ associé à chaque nœud

\begin{gather*}
    \left\{\begin{aligned}
         & m_I = \sum_p \varphi_{I}(\bx_p)~ m_p,                   \\
         & m_I \bm v_I  =  \sum_p \varphi_{I}(\bx_p)~ m_p \bm v_p, \\
         & \bm f_I  =  \sum_p \varphi_{I}(\bx_p)~\bm f_p.
    \end{aligned} \right.
\end{gather*}

\paragraph*{Mise à jour sur la grille}

L'équation~\ref{eq:mpm_pfd} est résolue sur les nœuds de la grille avec un schéma explicit

\begin{gather*}
    \left\{\begin{aligned}
        m_I \bm a_I     & =  \bm f_I + \bm f_g,                               \\
        m_I \bm v^{n+1} & =  \bm v^{n} + \Delta t~ (\bm f_I + \bm f_g) / m_I, \\
        \bm x_I^{n+1}   & =  \bm x_I^{n} + \Delta t~\bm v^{n+1}.
    \end{aligned} \right.
\end{gather*}

\paragraph*{interpolation}

Les quantités particulaires sont mises à jour par interpolation des quantités nodales afin de suivre la déformation de la grille mettant à jour positions $\bm x_p$ et leur vitesses $\bm v_p$. C'est ainsi que l'étape d'advection est prise en compte.

Celle-ci est réalisé directement par interpolation de la vitesse, de l'accélération, ou une combinaison des deux~\cite{stomakhin2013material} tel que

\begin{equation*}
    \bm v_{p}^{n+1} = \alpha \left(\bm v_{p}^{n} + \sum_I \varphi_{Ip} (\bm v_I^{n+1} - \bm v_I^{n})\right) + (1- \alpha)\sum_I \varphi_{Ip} \bm v_I^{n+1}
\end{equation*}~avec $\alpha \in [0, 1]$.

La position est mise jour en interpolant la déformation de la grille de telle sorte que

\begin{equation*}
    \bm x_p^{n+1} = \bm x_p^{n} + \Delta t \sum_I \varphi_I(\bm x_p^n)~\bm v_p^{n+1}
\end{equation*}

Des transferts plus plus complexes ont été développés afin d'offre des schémas plus stables et conservatifs~\cite{jiang_affine_2015,fu_polynomial_2017,hu_moving_2018}. Finalement, on retrouve également comme en~\eqref{eq:model_evol} des équations d'évolution pour les quantités particulaires en particulier pour la position et la vitesse

\begin{gather}
    \left\{\begin{aligned}
         & \frac{d\bm v_p(t)}{dt} = \mathbf I_v \circ \mathbf P_v(\bm v_p(t);\mathcal P), \\
         & \frac{d \bx_p(t)}{d t} = \mathbf I_x \circ \mathbf P_x(\bx(t);\mathcal P),
    \end{aligned} \right.
\end{gather}où $\mathbf P$ et $\mathbf I$ sont respectivement des opérateurs de projection et d'interpolation.

Tout comme la méthode SPH, des lois de comportement sont introduites pour pouvoir calculer $\bm f_p$, généralement grâce au tenseur de déformation, le tenseur de contrainte et de variable interne comme fait classiquement en mécanique des solides.

\subsection{Méthodes vortex}~\label{sec:vortex}

\subsubsection{Méthode vortex classique}

La méthode vortex est une méthode particulaire utilisée pour résoudre les équations de Navier-Stokes pour un écoulements incompressibles~\cite{Cottet_Koumoutsakos_2000}. Elle a été pour la première fois développée indépendamment par Prager~\cite{prager1928druckverteilung} et Rosenhead~\cite{rosenhead1931formation}. Elle se base sur la discrétisation du champ de tourbillon par un ensemble de particules, et résout la formulation vorticité-vitesse des équations de Navier-Stokes


\begin{gather*}
    \left\{\begin{aligned}
         & \frac{\partial \bm \omega}{\partial t} + (\bm{u} \cdot \nabla) \bm \omega  =  (\bm \omega \cdot \nabla) \bm u + \nu \Delta \bm \omega, \\
         & \Delta u   =  -\nabla \times \bm \omega,
    \end{aligned} \right.
\end{gather*}où $\bm{u}$ la vitesse, $\omega= \nabla \times \bm u$ le champ de tourbillon, et $\nu$ la viscosité.

Les formes lagrangiennes des équations précédentes sont
\begin{gather*}
    \left\{\begin{aligned}
         & \frac{d \bx_p}{dt} = \bm u(\bx_p, t),                                                                        \\
         & \frac{d\bm \omega_p}{dt} = - [\nabla \times \bm u (\bx_p, t)]\bm \omega_p + \nu \Delta \bm \omega(\bx_p, t).
    \end{aligned} \right.
\end{gather*}

Dans le cas d'un écoulement bi-dimensionnelle, le champ tourbillon est un champ scalaire porté par la troisième dimension. En particulier dans un repère cartésien $\omega = \frac{\partial v_y}{\partial x} - \frac{\partial v_x}{\partial y}$. De plus le terme d'étirement disparaît $(\bm \omega \cdot \nabla) \bm u$, ainsi les équations lagrangiennes se simplifient

\begin{gather*}
    \left\{\begin{aligned}
         & \frac{d \bx_p(t)}{dt} = \bm u(\bx_p, t)                    \\
         & \frac{d\omega(\bx_p, t)}{dt} = \nu \Delta \omega(\bx_p, t)
    \end{aligned} \right.
\end{gather*}

Le champ de vorticité est discrétisé à l'aide d'un ensemble de particules $p$ défini à une position $\bm _p$, une quantité de circulation locale $\Gamma_p$ qui est par définition la circulation autour de la particule $\Gamma_p = \oint_{\partial \Omega_p} \bm v = \int_{\Omega_p} \omega dS$. Ainsi, pour tout point $\bx \in \Omega \subset \mathbb R^2$ la vorticité peut être exprimée comme

\begin{equation*}
    \omega(\bm x, t) = \sum_{i=1}^{N_p} \Gamma_p(t) \phi_\varepsilon(\bm x - \bm x_p(t)),
\end{equation*}où $\phi_\varepsilon$ est le noyau de lissage.

La vitesse $\bm u$ peut être obtenue en résolvant l'équation de Poisson suivante

\begin{equation*}~\label{eq:poisson}
    \Delta \bm u = - \nabla \times \omega.
\end{equation*}

Finalement, par une représentation intégrale et en choisissant $\phi_\varepsilon = \delta$, on obtient dans le cas 2D l'équation de Biot-Savart suivante

\begin{equation*}
    \bm u(\bm x) = \sum_{p \in \mathcal P} \frac{\Gamma_p}{2\pi} \frac{(\bm x - \bm x_p)\times \bm k}{\|\bm x - \bm x_p\|_2^2},
\end{equation*}où $\bm k$ est le vecteur unitaire normal au plan.

En pratique, le choix d'un noyau en Dirac rend impossible le calcul de la vitesse sur la discrétisation particulaire à cause du dénominateur en ${\|\bm x - \bm x_p\|^2}$. En choisissant un noyau de type gaussien de taille $\varepsilon$ on obtient alors

\begin{equation*}
    \bm u(\bm x) = \sum_{p \in \mathcal P} \frac{\Gamma_p(1 - \exp(-r^2 / \varepsilon^2)) }{2\pi r^2} (\bm x - \bm x_p)\times \bm k, \quad r = \|\bm x - \bm x_p\|_2.
\end{equation*}

Afin de tenir compte de la diffusion, une approche par fractionnement est généralement utilisé. Introduite pour la première fois par Chorin~\cite{chorin_discretization_1973}, elle permet dans le cas de problème où le terme de transport est dominant, de traiter séparément et successivement les termes d'advection et de diffusion. Ainsi après avoir mis à jour la position des particules sans tenir compte de la viscosité, l'équation suivante est résolue

\begin{equation*}
    \frac{d\omega(\bm x_p, t)}{dt} = \nu \Delta \omega(\bx_p).
\end{equation*}

Pour se faire, deux méthodes sont principalement utilisées : soit la méthode par marche aléatoire~\cite{chorin_discretization_1973}, par étalement du noyau ou \textit{core spreading}~\cite{LEONARD1980289}, ou par échange d'intensité~\cite{1989MaCom..53..485D}. Dans le dernier cas, l'opérateur différentiel est approximé à l'aide de la discrétisation comme il est fait dans la méthode SPH. Dans ce dernier cas l'intensité évolue comme

\begin{equation*}
    \frac{d \omega_p}{dt} = \nu \varepsilon^{-2} \sum_q V_q [\omega_q - \omega_p] \phi_\varepsilon(\bx_p - \bx_q).
\end{equation*}

Finalement, on obtient également les équations d'évolution des quantités particulaires

\begin{gather*}
    \left\{\begin{aligned}
         & \frac{d \bx_p(t)}{dt} = \bm u(\bx_p(t), t),                                                                                                      \\
         & \frac{d\Gamma_p(t)}{dt} = \nu \varepsilon^{-2} \sum_{q \in \mathcal P} [V_p \Gamma_q(t) - V_q \Gamma_p(t)] \phi_\varepsilon(\bx_p(t) - \bx_q(t))
    \end{aligned}\right.
\end{gather*}

\subsubsection{\textit{Vortex-In-Cell} (VIC)}

La méthode \textit{Vortex-In-Cell}~\cite{christiansen_1973}, tout comme la méthode MPM~\ref{sec:mpm}, est une version \textit{Particle-In-Cell}~\cite{birdsall_1969} de la méthode Vortex précédemment décrite. Elle a été développé pour tenir compte de ses faiblesses. Comme la méthode MPM, celle-ci repose sur la représentation particulaire pour tenir compte du terme d'advection mais également d'une grille de calcul pour résoudre l'équation de Poisson en utilisant des méthodes eulériennes sur grille.

Le schéma de transfert est similaire à celui de la méthode MPM. D'abord une projection du champ de vorticité sur la grille de nœuds $\Lambda$ pour obtenir les valeurs nodales $\omega_I$ à l'aide d'une fonction de forme $W_I$

\begin{equation*}
    \omega_I = \frac{1}{V_I}\sum_{p \in \mathcal P} \Gamma_p W_I(\bx_p).
\end{equation*}

L'équation de Poisson~\ref{eq:poisson} est résolue sur la grille, soit par différences finies, soit par une méthode FFT pour obtenir des vitesses au nœud $\bm u_I$. La vitesse est ensuite interpolée sur le particule pour mettre à jour leur position

\begin{equation*}
    \frac{d \bm x_p}{d t} = \sum_{I \in \Lambda} \bm u_I W_I(\bx_p).
\end{equation*}
Le terme de diffusion peut également être pris en compte sur la grille de calcul. De plus, de cette manière l'étape de recherche de plus proche voisin n'est pas nécessaire, la résolution des équations se faisant directement sur la grille.

% \subsubsection{Similarité avec les méthodes SPH et MPM}



